<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selamat Ulang Tahun Fakhri üíô</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"> <!-- Untuk ikon -->
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Nunito Sans', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
            overflow-y: auto;
            color: white;
            background: linear-gradient(135deg, #0a0f22, #1a1a2e, #16213e);
            animation: bgShift 20s ease-in-out infinite alternate;
        }

        @keyframes bgShift {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        .bg {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at top, rgba(10, 15, 34, 0.8), rgba(0, 0, 0, 0.9));
            z-index: -2;
        }

        .container {
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        #clickText {
            cursor: pointer;
            font-size: 1.8rem;
            margin-bottom: 30px;
            animation: heartbeat 1.5s infinite;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            transition: transform 0.3s ease, color 0.3s ease;
        }

        #clickText:hover {
            transform: scale(1.1);
            color: #4fc3f7;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .envelope {
            position: relative;
            width: 320px;
            height: 210px;
            background: linear-gradient(145deg, #1f4f80, #2a71c7);
            border-radius: 0 0 12px 12px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.7), inset 0 0 20px rgba(255, 255, 255, 0.1);
            perspective: 1000px;
            transition: all 0.5s ease;
            filter: drop-shadow(0 0 10px rgba(42, 113, 199, 0.5));
        }

        .envelope:hover {
            transform: translateY(-5px);
        }

        .envelope::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            border-left: 160px solid transparent;
            border-right: 160px solid transparent;
            border-top: 115px solid #4fc3f7;
            transform-origin: top;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 3;
            box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.2);
        }

        .envelope.open::before {
            transform: rotateX(180deg);
            z-index: 1;
        }

        .paper {
            position: absolute;
            left: 12px;
            right: 12px;
            bottom: 12px;
            height: 190px;
            background: linear-gradient(145deg, #fff, #f0f0f0);
            border-radius: 8px;
            padding: 18px;
            overflow-y: auto;
            color: #333;
            font-size: 1rem;
            line-height: 1.6;
            box-shadow: 0 -12px 25px rgba(0, 0, 0, 0.2), inset 0 0 10px rgba(0, 0, 0, 0.05);
            transition: transform 1.3s cubic-bezier(0.22, 1, 0.36, 1), height 1.2s ease;
            z-index: 2;
            backdrop-filter: blur(5px); /* Fallback: hapus jika tidak didukung */
        }

        .envelope.open .paper {
            transform: translateY(-130px);
            height: 360px;
            animation: paperFloat 4s ease-in-out infinite;
        }

        @keyframes paperFloat {
            0%, 100% { transform: translateY(-130px) rotate(0deg); }
            50% { transform: translateY(-135px) rotate(0.5deg); }
        }

        .shake {
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        #typed-text span {
            opacity: 0;
            animation: fadeIn 0.2s forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        #cursor {
            display: inline-block;
            width: 3px;
            height: 1.2em;
            background: linear-gradient(90deg, #2a71c7, #4fc3f7);
            animation: blink 1s steps(1) infinite;
        }

        @keyframes blink {
            50% { opacity: 0; }
        }

        /* Confetti Animation */
        .confetti {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
            overflow: hidden;
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background: radial-gradient(circle, #ff6b6b, #feca57, #48dbfb, #0abde3);
            border-radius: 50%;
            animation: fall 3s linear infinite;
        }

        @keyframes fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        /* Kontrol Musik */
        .controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.4);
            transform: scale(1.1);
        }

        /* Responsivitas */
        @media (max-width: 768px) {
            .envelope {
                width: 280px;
                height: 180px;
            }
            .envelope::before {
                border-left: 140px solid transparent;
                border-right: 140px solid transparent;
                border-top: 100px solid #4fc3f7;
            }
            .paper {
                height: 160px;
            }
            .envelope.open .paper {
                height: 300px;
            }
            #clickText {
                font-size: 1.5rem;
            }
            .controls {
                bottom: 10px;
                right: 10px;
            }
        }

        /* Tombol Restart */
        #restartBtn {
            margin-top: 30px;
            padding: 12px 24px;
            background: linear-gradient(145deg, #2a71c7, #4fc3f7);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: none;
        }

        #restartBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
    </style>
</head>
<body>
    <div class="bg"></div>
    <div class="confetti" id="confetti"></div>
    <div class="container">
        <h2 id="clickText" aria-label="Klik untuk membuka kartu ulang tahun" tabindex="0">Coba klik üéÅ <i class="fas fa-gift"></i></h2>
        <div class="envelope" id="envelope">
            <div class="paper" id="paper">
                <span id="typed-text"></span><span id="cursor"></span>
            </div>
        </div>
        <button id="restartBtn" aria-label="Mulai ulang animasi">Mulai Ulang <i class="fas fa-redo"></i></button>
    </div>
    <div class="controls">
        <button class="control-btn" id="musicToggle" aria-label="Toggle musik"><i class="fas fa-play"></i></button>
    </div>
    <audio id="bg-music" src="lagu.mp3" preload="auto" loop></audio>
    <script>
        const clickText = document.getElementById('clickText');
        const envelope = document.getElementById('envelope');
        const paper = document.getElementById('paper');
        const typedText = document.getElementById('typed-text');
        const cursor = document.getElementById('cursor');
        const music = document.getElementById('bg-music');
        const restartBtn = document.getElementById('restartBtn');
        const musicToggle = document.getElementById('musicToggle');
        const confettiContainer = document.getElementById('confetti');

        const message = `WAKE UPPP BABYYYY! IT'S YOUR BIRTHDAY! happy birthday üíôüéâ

to youuu, my boo, my sunshine, my everything. hari ini hari kamu, dan aku mau kamu tau seberapa besar aku sayang dan cinta sama kamu. on your special day, i love you now, and always will. in every possible way.

kamu itu tenang di saat aku marah, kamu itu peluk nyaman pas aku cape, kamu itu rumah buat hatiku yang sering nyasar. you are the one i care about most, lebih dari apa pun.

kamu adalah cahaya yang terangin badaiku, dan aku harap kita bisa deket terus kaya gini selamanya. i can't even find the right words to explain how much you mean to me.

rasanya tuh, kalau pakai kata-kata malah ga cukup. kadang cinta itu terlalu besar buat dijelasin, tapi selalu bisa dirasain dan kamu pasti bisa ngerasain itu dari aku.

so on your birthday, i just want to remind you again ‚Äî i choose you. setiap hari. setiap waktu. in every lifetime, i'd still choose you.

and i'll say it again and again, karena ulang tahun kamu bukan cuma perayaan umur, tapi juga kesempatan buat aku bilang:

I LOVE JUST YOU!

hari ini, nikmatin setiap momen ya. tertawa, bahagia, dikelilingi cinta dari orang-orang terdekatmu.

dan jangan lupa,
ada aku yang paling depan,
paling kenceng teriaknya‚Ä¶

HAPPY BIRTHDAY SAYANGGG! ü§ç`;

        let i = 0;
        let opened = false;
        let typingInterval;
        let isPlaying = false;

        // Fungsi untuk membuat confetti
        function createConfetti() {
            for (let j = 0; j < 50; j++) {
                const piece = document.createElement('div');
                piece.classList.add('confetti-piece');
                piece.style.left = Math.random() * 100 + '%';
                piece.style.animationDelay = Math.random() * 2 + 's';
                confettiContainer.appendChild(piece);
                setTimeout(() => piece.remove(), 3000);
            }
        }

        // Fungsi untuk membuka envelope
        function openEnvelope() {
            if (opened) return;
            opened = true;

            envelope.classList.add('shake');
            setTimeout(() => {
                envelope.classList.remove('shake');
                envelope.classList.add('open');
                createConfetti(); // Tambahkan confetti

                music.volume = 0.5;
                music.play().catch(() => {
                    console.warn('Musik tidak dapat dimainkan. Pastikan file "lagu.mp3" ada.');
                });
                isPlaying = true;
                musicToggle.innerHTML = '<i class="fas fa-pause"></i>';

                setTimeout(() => {
                    typeChar();
                }, 1000);
            }, 500);

            clickText.style.display = 'none';
        }

        // Event listener untuk klik teks
        clickText.addEventListener('click', openEnvelope);
        clickText.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') openEnvelope();
        });

        // Fungsi typing dengan variasi kecepatan
        function typeChar() {
            if (i < message.length) {
                const char = message[i++];
                const span = document.createElement('span');
                span.textContent = char;
                typedText.appendChild(span);
                paper.scrollTop = paper.scrollHeight;

                // Variasi kecepatan: lebih cepat untuk spasi, lebih lambat untuk tanda baca
                let delay = 50;
                if (char === ' ' || char === '\n') delay = 20;
                else if (['!', '.', '?', ','].includes(char)) delay = 100;

                typingInterval = setTimeout(typeChar, delay);
            } else {
                cursor.style.display = 'none';
                restartBtn.style.display = 'block';
            }
        }

        // Tombol restart
        restartBtn.addEventListener('click', () => {
            opened = false;
            i = 0;
            typedText.innerHTML = '';
            cursor.style.display = 'inline-block';
            envelope.classList.remove('open', 'shake');
            clickText.style.display = 'block';
            restartBtn.style.display = 'none';
            music.pause();
            music.currentTime = 0;
            isPlaying = false;
            musicToggle.innerHTML = '<i class="fas fa-play"></i>';
            confettiContainer.innerHTML = '';
            clearTimeout(typingInterval);
        });

        // Toggle musik
        musicToggle.addEventListener('click', () => {
            if (isPlaying) {
                music.pause();
                musicToggle.innerHTML = '<i class="fas fa-play"></i>';
            } else {
                music.play().catch(() => {
                    console.warn('Musik tidak dapat dimainkan.');
                });
                musicToggle.innerHTML = '<i class="fas fa-pause"></i>';
            }
            isPlaying = !isPlaying;
        });
    </script>
</body>
</html>
